{% extends 'base.html' %}

{% block title %}{{ course.title }} | Learn | PyClimb{% endblock %}

{% block extra_styles %}
a.back {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: var(--accent);
  text-decoration: none;
  font-size: 0.95rem;
  letter-spacing: 0.02em;
}

header.course-header {
  margin: 16px 0 24px;
  padding: 24px;
  background: linear-gradient(180deg, #fffaf0 0%, #fff3dc 100%);
  border-radius: 0;
  border: 2px solid var(--pixel-border);
  box-shadow: 4px 4px 0 #dfbd93;
}

header.course-header h1 {
  margin: 0 0 12px;
  font-size: clamp(2rem, 4vw, 3rem);
}

header.course-header .description {
  margin: 0;
  color: var(--muted);
  font-size: 1.05rem;
  line-height: 1.6;
}

header.course-header .meta {
  margin-top: 16px;
  font-size: 0.9rem;
  color: var(--muted);
}

.draft-badge {
  display: inline-block;
  padding: 2px 10px;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--warning);
  background: #fff3cd;
  border: 2px solid #a36c2c;
  border-radius: 0;
  margin-left: 12px;
}

.section-title {
  margin: 24px 0 16px;
  font-size: 1.2rem;
}

ol.lesson-list {
  list-style: none;
  margin: 0;
  padding: 0;
  counter-reset: lesson-counter;
}

ol.lesson-list li {
  counter-increment: lesson-counter;
}

a.lesson-item {
  display: flex;
  align-items: flex-start;
  gap: 16px;
  padding: 18px 20px;
  background: #fff8e8;
  border: 2px solid var(--pixel-border);
  border-radius: 0;
  text-decoration: none;
  color: inherit;
  margin-bottom: 12px;
  box-shadow: 3px 3px 0 #dfbd93;
  transition: transform 120ms ease, box-shadow 120ms ease;
}

a.lesson-item:hover {
  border-color: var(--pixel-border);
  box-shadow: 2px 2px 0 #b4784d;
  transform: translate(1px, 1px);
}

a.lesson-item.draft {
  opacity: 0.7;
  border-style: dashed;
}

.lesson-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  background: var(--bg);
  border-radius: 0;
  border: 2px solid var(--pixel-border);
  font-weight: 600;
  color: var(--accent);
  flex-shrink: 0;
}

.lesson-number::before {
  content: counter(lesson-counter);
}

.lesson-content {
  flex: 1;
}

.lesson-content h3 {
  margin: 0 0 4px;
  font-size: 1.1rem;
}

.lesson-content .summary {
  margin: 0;
  color: var(--muted);
  font-size: 0.9rem;
  line-height: 1.5;
}

.lesson-draft-tag {
  display: inline-block;
  padding: 2px 8px;
  font-size: 0.75rem;
  color: var(--warning);
  background: #fff3cd;
  border: 1px solid #a36c2c;
  border-radius: 0;
  margin-left: 8px;
}

.empty {
  padding: 32px;
  text-align: center;
  color: var(--muted);
  background: #fff8e8;
  border-radius: 0;
  border: 2px solid var(--pixel-border);
  box-shadow: 3px 3px 0 #dfbd93;
}
{% endblock %}

{% block content %}
<a class="back" href="{% url 'lessons:index' %}">‚Üê Back to all courses</a>

<header class="course-header">
  <h1>
    {{ course.title }}
    {% if not course.is_published %}
      <span class="draft-badge">Draft</span>
    {% endif %}
  </h1>
  {% if course.description %}
    <p class="description">{{ course.description }}</p>
  {% endif %}
  <p class="meta">{{ lessons|length }} lesson{{ lessons|length|pluralize }}</p>
</header>

{% if lessons %}
  <h2 class="section-title">Lessons</h2>
  <ol class="lesson-list">
    {% for lesson in lessons %}
      <li>
        <a class="lesson-item {% if not lesson.is_published %}draft{% endif %}" 
           href="{% url 'lessons:lesson_detail' course.slug lesson.slug %}">
          <span class="lesson-number"></span>
          <div class="lesson-content">
            <h3>
              {{ lesson.title }}
              {% if not lesson.is_published %}
                <span class="lesson-draft-tag">Draft</span>
              {% endif %}
            </h3>
            {% if lesson.summary %}
              <p class="summary">{{ lesson.summary }}</p>
            {% endif %}
          </div>
        </a>
      </li>
    {% endfor %}
  </ol>
{% else %}
  <p class="empty">No lessons in this course yet.</p>
{% endif %}
{% endblock %}
