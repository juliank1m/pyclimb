{% extends 'base.html' %}

{% block title %}PyClimb - Python Coding Challenges{% endblock %}

{% block extra_styles %}
.hero {
  text-align: center;
  padding: 48px 20px 40px;
}
.hero h1 {
  margin: 0 0 12px;
  font-size: clamp(2.5rem, 5vw, 4rem);
  letter-spacing: 0.01em;
  color: var(--ink);
}
.hero h1 span {
  color: var(--accent);
}
.hero .tagline {
  margin: 0 0 32px;
  font-size: 1.2rem;
  color: var(--muted);
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}
.hero .cta-buttons {
  display: flex;
  gap: 16px;
  justify-content: center;
  flex-wrap: wrap;
}
.hero .btn-secondary {
  background: transparent;
  color: var(--ink);
  border: 2px solid var(--ink);
}
.hero .btn-secondary:hover {
  background: var(--ink);
  color: var(--bg);
}
.hero .btn-tertiary {
  background: transparent;
  color: var(--accent);
  border: 2px solid var(--accent);
}
.hero .btn-tertiary:hover {
  background: var(--accent);
  color: white;
}

/* Stats */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 16px;
  margin: 32px 0;
}
.stat-card {
  background: #fff8e8;
  border: 2px solid var(--pixel-border);
  border-radius: 0;
  box-shadow: 3px 3px 0 #dfbd93;
  padding: 20px;
  text-align: center;
}
.stat-card .number {
  display: block;
  font-size: 2rem;
  font-weight: 600;
  color: var(--accent);
  margin-bottom: 4px;
}
.stat-card .label {
  color: var(--muted);
  font-size: 0.9rem;
}

/* Difficulty breakdown */
.difficulty-breakdown {
  display: flex;
  justify-content: center;
  gap: 24px;
  margin: 24px 0;
  flex-wrap: wrap;
}
.difficulty-item {
  display: flex;
  align-items: center;
  gap: 8px;
}
.difficulty-dot {
  width: 12px;
  height: 12px;
  border-radius: 0;
  border: 1px solid var(--pixel-border);
}
.difficulty-dot.easy { background: #27ae60; }
.difficulty-dot.medium { background: #f39c12; }
.difficulty-dot.hard { background: #c0392b; }
.difficulty-item .count {
  font-weight: 600;
}
.difficulty-item .name {
  color: var(--muted);
}

/* Featured problems */
.featured-section {
  margin-top: 48px;
}
.featured-section h2 {
  text-align: center;
  font-size: 1.5rem;
  margin: 0 0 24px;
  letter-spacing: 0.02em;
}
.featured-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 16px;
}
a.problem-card {
  display: block;
  padding: 18px 18px 16px;
  background: linear-gradient(180deg, #fffaf0 0%, #fff3dc 100%);
  border: 2px solid var(--pixel-border);
  border-radius: 0;
  text-decoration: none;
  color: inherit;
  box-shadow: 4px 4px 0 #e9b47f;
  transition: transform 120ms ease, box-shadow 120ms ease;
}
a.problem-card.easy {
  box-shadow: 4px 4px 0 #8dbf7a;
}
a.problem-card.medium {
  box-shadow: 4px 4px 0 #e9b47f;
}
a.problem-card.hard {
  box-shadow: 4px 4px 0 #b65a67;
}
a.problem-card:hover {
  transform: translate(1px, 1px);
  box-shadow: 3px 3px 0 #a76f45;
  border-color: var(--pixel-border);
}
a.problem-card.easy:hover {
  box-shadow: 3px 3px 0 #6f9f5f;
}
a.problem-card.medium:hover {
  box-shadow: 3px 3px 0 #c18b58;
}
a.problem-card.hard:hover {
  box-shadow: 3px 3px 0 #8a3f4a;
}
a.problem-card.solved {
  border-color: #777066;
  box-shadow: 4px 4px 0 #a6a09a !important;
  background: linear-gradient(180deg, #f4f1ea 0%, #ebe6dd 100%);
  filter: grayscale(0.55);
}
a.problem-card.solved:hover {
  box-shadow: 3px 3px 0 #8f8983 !important;
}
.card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 10px;
}
.difficulty {
  display: inline-block;
  padding: 2px 10px 4px;
  font-size: 0.85rem;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  border: 2px solid;
  border-radius: 0;
  background: #fff8e8;
}
.difficulty.easy {
  color: #27ae60;
  border-color: rgba(39, 174, 96, 0.3);
}
.difficulty.medium {
  color: #f39c12;
  border-color: rgba(243, 156, 18, 0.3);
}
.difficulty.hard {
  color: #c0392b;
  border-color: rgba(192, 57, 43, 0.3);
}
.solved-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  font-size: 0.75rem;
  font-weight: 600;
  color: #27ae60;
  background: #d4edda;
  border: 2px solid #2a7b4f;
  border-radius: 0;
}
.solved-badge svg {
  width: 12px;
  height: 12px;
}
.problem-card .title {
  margin: 0 0 8px;
  font-size: 1.25rem;
}
.problem-card .meta {
  margin: 0;
  color: var(--muted);
  font-size: 0.95rem;
}

.view-all {
  text-align: center;
  margin-top: 32px;
}

/* Learning section */
.learning-section {
  margin: 40px 0 12px;
  background: #fff7ec;
  border: 2px solid var(--pixel-border);
  border-radius: 0;
  box-shadow: 4px 4px 0 #dfbd93;
  padding: 28px;
  display: grid;
  gap: 20px;
  grid-template-columns: minmax(0, 2fr) minmax(0, 1fr);
  align-items: center;
}
.learning-section h2 {
  margin: 0 0 8px;
  font-size: 1.6rem;
}
.learning-section p {
  margin: 0;
  color: var(--muted);
  max-width: 520px;
}
.learning-stats {
  display: grid;
  gap: 12px;
}
.learning-card {
  background: #fffef8;
  border: 2px solid var(--pixel-border);
  border-radius: 0;
  box-shadow: 3px 3px 0 #dfbd93;
  padding: 14px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.learning-card .label {
  color: var(--muted);
  font-size: 0.9rem;
}
.learning-card .value {
  font-weight: 600;
  color: var(--accent);
}
.learning-actions {
  margin-top: 14px;
}
.learning-section .btn {
  padding: 10px 18px;
}
@media (max-width: 820px) {
  .learning-section {
    grid-template-columns: 1fr;
  }
}

/* User progress */
.progress-banner {
  background: linear-gradient(135deg, var(--accent) 0%, #b85a15 100%);
  color: white;
  border-radius: 0;
  border: 2px solid var(--pixel-border);
  box-shadow: 4px 4px 0 #a9653a;
  padding: 24px;
  margin: 32px 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 16px;
}
.progress-banner .progress-text h3 {
  margin: 0 0 4px;
  font-size: 1.3rem;
}
.progress-banner .progress-text p {
  margin: 0;
  opacity: 0.9;
}
.progress-banner .btn {
  background: white;
  color: var(--accent);
}
.progress-banner .btn:hover {
  background: var(--bg);
}
{% endblock %}

{% block content %}
<section class="hero">
  <h1>Py<span>Climb</span></h1>
  <p class="tagline">Sharpen your Python skills with hands-on coding challenges and guided lessons. Practice, learn, and climb the leaderboard.</p>
  <div class="cta-buttons">
    <a href="{% url 'problems:index' %}" class="btn">Browse Problems</a>
    <a href="{% url 'lessons:index' %}" class="btn btn-tertiary">Start Learning</a>
    {% if not user.is_authenticated %}
      <a href="{% url 'register' %}" class="btn btn-secondary">Get Started</a>
    {% else %}
      <a href="{% url 'leaderboard' %}" class="btn btn-secondary">View Leaderboard</a>
    {% endif %}
  </div>
</section>

<div class="stats-grid">
  <div class="stat-card">
    <span class="number">{{ total_problems }}</span>
    <span class="label">Problems</span>
  </div>
  <div class="stat-card">
    <span class="number">{{ total_users }}</span>
    <span class="label">Users</span>
  </div>
  <div class="stat-card">
    <span class="number">{{ total_submissions }}</span>
    <span class="label">Submissions</span>
  </div>
  {% if user.is_authenticated %}
    <div class="stat-card">
      <span class="number">{{ solved_count }}</span>
      <span class="label">Solved by You</span>
    </div>
  {% endif %}
</div>

<section class="learning-section">
  <div>
    <h2>Learn with guided lessons</h2>
    <p>Follow curated courses or jump into standalone lessons to build the concepts behind the problems.</p>
    <div class="learning-actions">
      <a href="{% url 'lessons:index' %}" class="btn">Explore Learn</a>
    </div>
  </div>
  <div class="learning-stats">
    <div class="learning-card">
      <span class="label">Courses</span>
      <span class="value">{{ total_courses }}</span>
    </div>
    <div class="learning-card">
      <span class="label">Lessons</span>
      <span class="value">{{ total_lessons }}</span>
    </div>
  </div>
</section>

<div class="difficulty-breakdown">
  <div class="difficulty-item">
    <span class="difficulty-dot easy"></span>
    <span class="count">{{ easy_count }}</span>
    <span class="name">Easy</span>
  </div>
  <div class="difficulty-item">
    <span class="difficulty-dot medium"></span>
    <span class="count">{{ medium_count }}</span>
    <span class="name">Medium</span>
  </div>
  <div class="difficulty-item">
    <span class="difficulty-dot hard"></span>
    <span class="count">{{ hard_count }}</span>
    <span class="name">Hard</span>
  </div>
</div>

{% if user.is_authenticated and solved_count < total_problems %}
  <div class="progress-banner">
    <div class="progress-text">
      <h3>Keep climbing!</h3>
      <p>You've solved {{ solved_count }} of {{ total_problems }} problems. {{ total_problems|add:"-solved_count"|default:total_problems }} more to go!</p>
    </div>
    <a href="{% url 'problems:index' %}?status=unsolved" class="btn">Continue Practice</a>
  </div>
{% endif %}

{% if featured_problems %}
  <section class="featured-section">
    <h2>Featured Problems</h2>
    <div class="featured-grid">
      {% for problem in featured_problems %}
        <a class="problem-card {% if problem.difficulty == 1 %}easy{% elif problem.difficulty == 2 %}medium{% else %}hard{% endif %} {% if problem.id in solved_problem_ids %}solved{% endif %}" href="{% url 'problems:detail' problem.slug %}">
          <div class="card-header">
            <span class="difficulty {% if problem.difficulty == 1 %}easy{% elif problem.difficulty == 2 %}medium{% else %}hard{% endif %}">
              {{ problem.get_difficulty_display }}
            </span>
            {% if problem.id in solved_problem_ids %}
              <span class="solved-badge">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                Solved
              </span>
            {% endif %}
          </div>
          <h3 class="title">{{ problem.title }}</h3>
          <p class="meta">{{ problem.description|truncatewords:12 }}</p>
        </a>
      {% endfor %}
    </div>
    <div class="view-all">
      <a href="{% url 'problems:index' %}" class="btn">View All Problems</a>
    </div>
  </section>
{% endif %}
{% endblock %}
