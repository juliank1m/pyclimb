{% extends 'base.html' %}

{% block title %}Set New Password | PyClimb{% endblock %}

{% block extra_styles %}
.auth-card {
  max-width: 420px;
  margin: 40px auto;
  padding: 32px;
  background: var(--card);
  border-radius: 16px;
  border: 1px solid #efe7d7;
  box-shadow: 0 8px 20px rgba(34, 32, 19, 0.08);
}
.auth-card h1 {
  margin: 0 0 12px;
  font-size: 1.8rem;
  text-align: center;
}
.auth-card .subtitle {
  margin: 0 0 24px;
  text-align: center;
  color: var(--muted);
  font-size: 0.95rem;
}
.form-group {
  margin-bottom: 20px;
}
.form-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
  font-size: 0.95rem;
}
.form-group input {
  width: 100%;
  padding: 12px 14px;
  font-family: inherit;
  font-size: 1rem;
  border: 1px solid #ddd;
  border-radius: 8px;
  background: #fafafa;
}
.form-group input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--ring);
}
.auth-card .btn {
  width: 100%;
  margin-top: 8px;
}
.error-list {
  margin: 0 0 20px;
  padding: 12px 16px;
  background: #fdf2f2;
  border: 1px solid var(--error);
  border-radius: 8px;
  color: var(--error);
  list-style: none;
  font-size: 0.95rem;
}
.invalid-link {
  text-align: center;
  padding: 24px;
}
.invalid-link h2 {
  margin: 0 0 12px;
  color: var(--error);
}
.invalid-link p {
  color: var(--muted);
  margin: 0 0 16px;
}
.invalid-link a {
  color: var(--accent);
  text-decoration: none;
}
.invalid-link a:hover {
  text-decoration: underline;
}
{% endblock %}

{% block content %}
<div class="auth-card">
  {% if validlink %}
    <h1>Set New Password</h1>
    <p class="subtitle">Please enter your new password.</p>
    
    {% if form.errors %}
      <ul class="error-list">
        {% for field in form %}
          {% for error in field.errors %}
            <li>{{ error }}</li>
          {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}
          <li>{{ error }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    
    <form method="post">
      {% csrf_token %}
      <div class="form-group">
        <label for="id_new_password1">New Password</label>
        <input type="password" name="new_password1" id="id_new_password1" required autofocus>
      </div>
      <div class="form-group">
        <label for="id_new_password2">Confirm Password</label>
        <input type="password" name="new_password2" id="id_new_password2" required>
      </div>
      <button type="submit" class="btn">Set New Password</button>
    </form>
  {% else %}
    <div class="invalid-link">
      <h2>Invalid Reset Link</h2>
      <p>This password reset link is invalid or has expired.</p>
      <a href="{% url 'password_reset' %}">Request a new reset link</a>
    </div>
  {% endif %}
</div>
{% endblock %}
